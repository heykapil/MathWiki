<div class="topSpace"></div>

Date Created: 07/11/2023 20:27:28
Tags: #Type/Theorem #In_Progress

Proved by: [[Monotone Class Lemma]], [[Measure Space#^monotone-convergence-of-sets]], [[Pointwise-limits of measurable functions are measurable]], [[Monotone Convergence Theorem]], [[Dominated Convergence Theorem]]
References: <i>Not Applicable</i>
Justifications: <i>Not Applicable</i>

Specializations: <i>Not Applicable</i>
Generalizations: <i>Not Applicable</i>

``` ad-Theorem
title: Theorem (Fubini-Tonelli).

Let $\tpl{X,\mc{M},\mu}$ and $\tpl{Y,\mc{N},\nu}$ be two $\sigma$-finite measure spaces and let $f:X\times Y\to\bar{\R}$ be $\l(\mu\times\nu\r)$-measurable. Then (i) the fibers $f_x$ and $f^y$ are respectively $\mu$ and $\nu$-measurable for $\mu$-a.e. $x\in X$ and $\nu$-a.e. $y\in Y$; (ii) if either $f\geq0$ or $f\in L^1$, then the a.e. defined functions $g:x\mapsto\int f_x\d\nu$ and $h:y\mapsto\int f^y\d\mu$ are respectively $\mu$ and $\nu$-measurable, and in the latter case, they are in fact integrable; and (iii) we have in either case that
$$\begin{equation}
    \iint f\d\nu\d\mu=\int f\d\!\l(\mu\times\nu\r)=\iint f\d\mu\d\nu.
\end{equation}$$

Moreover, if $f$ is $\l(\mc{M}\otimes\mc{N}\r)$-measurable, then in fact $f_x,g$ are $\mc{M}$-measurable for all $x\in X$ and $f^y,h$ are $\mc{N}$-measurable for all $y\in Y$.

```

<i>Proof.</i> Let $\mc{B}\coloneqq\mc{M}\otimes\mc{N}$ and $\rho\coloneqq\mu\times\nu$. We first prove the <i>Fubini-Tonelli theorem for sets</i>, which states that for all $R\in\mc{B}$, we have $R_x\in\mc{M}$ and $R^y\in\mc{N}$ for all $x\in X$ and $y\in Y$, that the functions $g:x\mapsto\nu\l(R_x\r)$ and $h:y\mapsto\mu\l(R^y\r)$ are respectively $\mc{M}$ and $\mc{N}$-measurable, and that $\int\nu\l(R_x\r)\d\mu=\rho\l(R\r)=\int\mu\l(R^y\r)\d\nu$. Indeed, let $\mc{S}$ be the collection of all $R\in\mc{B}$ for which the conclusion holds. Then $\mc{S}$ contains all rectangles $R=M\times N$, where $M\in\mc{M}$ and $N\in\mc{N}$, since the fibers are just $M$ and $N$, $g\l(x\r)=\nu\l(R_x\r)=\nu\l(N\r)\cchi_M\!\l(x\r)$ is an indicator function for all $x\in X$ and similarly for $h\l(y\r)$, and the integrals coincide by definition of $\rho$. It also contains complements and finite unions of <i>rectangles</i>, so it contains the algebra $\mc{A}$ generated by rectangles. Assuming that $\mu$ and $\nu$ are finite, we show that $\mc{S}$ is closed under increasing unions and decreasing intersections; the Monotone Class Lemma then shows that $\mc{S}=\gen{\mc{A}}_\sigma=\mc{B}$ in the finite case.
* (Union). Let $R_n\in\mc{S}$ be an increasing sequence and let $R\coloneqq\bigcup_nR_n$, so $R^y=\l(\bigcup_nR_n\r)^y=\bigcup_nR_n^y\in\mc{N}$ for all $y\in Y$ and similarly for all $x\in X$. Moreover, we have that $h\l(y\r)=\mu\l(R^y\r)=\mu\l(\bigcup_nR_n^y\r)=\lim_n\mu\l(R_n^y\r)=\lim_nh_n\!\l(y\r)$ for all $y$, so $h$ is $\mc{N}$-measurable. Similarly for $g$, and the integrals coincide by the MCT.
* (Intersection). Let $R_n\in\mc{S}$ be a decreasing sequence and let $R\coloneqq\bigcap_nR_n$, so $R^y=\l(\bigcap_nR_n\r)^y=\bigcap_nR_n^y\in\mc{N}$ for all $y\in Y$ and similarly for all $x\in X$. Moreover, we have $h\l(y\r)=\mu\l(R^y\r)=\mu\l(\bigcap_nR_n^y\r)=\lim_n\mu\l(R_n^y\r)=\lim_nh_n\!\l(y\r)$ for all $y$ by finiteness of $\mu$, so $h$ is $\mc{N}$-measurable. Similarly for $g$ (by finiteness of $\nu$), and the integrals coincide by the DCT.

For general $\sigma$-finite measures $\mu$ and $\nu$, let $X=\bigcup_nX_n$ and $Y=\bigcup_nY_n$ be increasing unions of finite measure sets. Then $X\times Y=\bigcup_n\l(X_n\times Y_n\r)$ is an increasing union, and for any $R\in\mc{M}\otimes\mc{N}$, the statements hold for every $R_n\coloneqq R\cap\l(X_n\times Y_n\r)$ and hence holds for $R$ too by monotonicity of $\rho$ and the MCT.

Next, we prove the theorem in the case when $f$ is $\mc{B}$-measurable. Indeed, for each $C\in\mc{B}\,(\bar{\R})$ and all $x\in X$, we have $f^{-1}_x\!\l(C\r)=\l(f^{-1}\!\l(C\r)\r)_x\in\mc{N}$ by Fubini-Tonelli for sets. The rest of the claims reduce to Fubini-Tonelli for sets in the case when $f$ is an indicator function, so by linearity they hold when $f$ is simple. But any $f\geq0$ can be approximated by simple functions and any $f\in L^1$ decomposes as $f^+-f^-$, so the results follow by the MCT and linearity.

Finally, we extend the result to $\rho$-measurable functions $f$. To do so, we fix a countable basis $\l\{C_n\r\}$ of $\bar{\R}$ and, for each $n$, write $f^{-1}\!\l(C_n\r)=B_n\cup Z_n$ for some $B_n\in\mc{B}$ and some $\rho$-null sets $Z_n$.
