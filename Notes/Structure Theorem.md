<div class="topSpace"></div>

Date Created: 23/07/2023 20:35:54
Tags: #Type/Theorem #In_Progress

Proved by: [[Characterizations of PIDs]], [[Universal Property of Free Modules]], [[Basic properties of rank]], [[Splitting Lemma]], [[PID implies UFD]], [[Bezout's Identity]], [[Isomorphism Theorems]], [[Basic properties of quotient modules]], [[Basis Extension Theorem]], [[Chinese Remainder Theorem]], [[Freedom Theorem for Modules over PID]]
References: <i>Not Applicable</i>
Justifications: <i>Not Applicable</i>

Specializations: <i>Not Applicable</i>
Generalizations: <i>Not Applicable</i>

``` ad-Theorem
title: Theorem (Structure Theorem for Finitely-generated Modules over PIDs).

Let $M$ be a finitely-generated module over a PID $R$. Then we have a decomposition $M\iso R^{\rk M}\oplus\Tor M$, and furthermore:
* (Elementary Divisors). There exist distinct prime ideals $\gen{p_i}\nsubgrp R$ and positive integers $\alpha_{ij}\in\N$ such that $\Tor M\iso\bigoplus_{i=1}^n\bigoplus_{j=1}^mR/\langle p_i^{\alpha_{ij}}\rangle$.
* (Invariant Factors). There exist an ascending chain $\gen{a_1}\supseteq\gen{a_2}\supseteq\cdots\supseteq\gen{a_m}$ of non-zero ideals $\gen{a_j}\nsubgrp R$ such that $\Tor M\iso\bigoplus_{j=1}^mR/\!\gen{a_j}$.

Both decompositions of $\Tor M$ are unique up to a permutation of the factors.

```

<i>Proof.</i> We claim that the exact sequence $0\to\Tor M\to M\to M/\Tor M\to 0$ splits. Indeed, since $M/\Tor M$ is torsion-free and $R$ is a PID, we see that $M/\Tor M$ is free so $\pi:M\onto M/\Tor M$ admits a splitting $\phi:M/\Tor M\to M$ mapping the basis elements $e_i\mapsto m_i\in\pi^{-1}\!\l(e_i\r)\in M$. Since $\rk\l(M/\Tor M\r)=\rk M$, we obtain the desired torsion decomposition $M\iso R^{\rk M}\oplus\Tor M$. Henceforth, we assume w.l.o.g. that $M=\Tor M$; its decomposition will proceed in several steps.
1. For each prime ideal $\mf{p}\coloneqq\gen{p}\nsubgrp R$, set $M\l(\mf{p}\r)\coloneqq\l\{m\in M\st\ex\alpha\geq 1:p^\alpha m=0\r\}$. We first establish the <i>primary decomposition</i> $M\iso\bigoplus_\mf{p}M\l(\mf{p}\r)$, where the direct sum is taken over all non-zero prime ideals $\mf{p}\nsubgrp R$. Furthermore, we show that $M\l(\mf{p}\r)$ vanishes for cofinitely-many $\mf{p}$.
2. For each $\mf{p}\coloneqq\gen{p}$ in the primary decomposition, we show that $M\l(\mf{p}\r)\iso\bigoplus_{j=1}^mR/\!\gen{p^{\alpha_j}}$ for some unique $m\in\N$ and unique positive integers $\alpha_1\leq\cdots\leq\alpha_m$.
3. Finally, we use the Chinese Remainder Theorem to combine the primes into a unique ascending chain $\gen{a_1}\supseteq\gen{a_2}\supseteq\cdots\supseteq\gen{a_m}$ of non-zero ideals $\gen{a_j}\nsubgrp R$, giving us the invariant factors decomposition of $M$.

We prove the primary decomposition of $M$. For all $r\in R$, let $M_a$ denote the kernel of the endomorphism $m\mapsto am$. Since $M$ is torsion, we see that $\Ann M\neq\l\{0\r\}$ and so there is some $a\in R$ such that $M_a=M$. Since $R$ is also a UFD, write $a=u\prod_{i=1}^{n}p_i^{\alpha_i}$, and set $b\coloneqq p_1^{\alpha_1}$ and $c\coloneqq a/b$. We claim that $M=M_b\oplus M_c$, from which the result follows by induction. 
* Since $a\perp b$, Bézout’s Identity furnishes $r,s\in R$ so that $rb+sc=1$. Take $m\in M$, so $m=rbm+scm$. Then $c\l(rbm\r)=arm=0$ and $b\l(scm\r)=asm=0$, so $m\in M_b+M_c$. Furthermore, if $bm=cm=0$, then $m=rbm+scm=0$.

Fix a prime $\mf{p}\coloneqq\gen{p}$ in the primary decomposition of $M$ and write $N\coloneqq M\l(\mf{p}\r)\iso\gen{x_j}_{j=1}^m$ for some $m\in\N$ and $x_j\in M\l(\mf{p}\r)$. Let $\alpha\geq1$ be the smallest integer so that $p^\alpha M=0$ and let $x\in N$ have order $\gen{p^\alpha}$. Set $\bar{N}\coloneqq N/\!\gen{x}$ and consider the exact sequence $0\to\gen{x}\to N\overset{\pi}{\to}\bar{N}\to0$. We need the following lemma.
* If $\bar{y}\in\bar{N}$ has order $\gen{p^\beta}$ for some $\beta\geq1$, then it admits a representative $y\in N$ having the same order. Indeed, let $z\in\pi^{-1}\!\l(\bar{y}\r)$, so $\pi\l(p^\beta z\r)=p^\beta\pi\l(z\r)=p^\beta\bar{y}=0$ and hence $p^\beta z\in\gen{x}$. Thus $p^\beta z=rx$ for some $r\in R$. Observe that $0=p^\alpha z=p^{\alpha-\beta}rx$, so, since $\ord x=\gen{p^\alpha}$, we have $r=p^\beta s$ for some $s\in R$. Set $y\coloneqq z-sx$, which projects onto $\bar{y}$. Its order is $\gen{p^\beta}$ since $p^\beta y=p^\beta z-p^\beta sx=rx-rx=0$ and $\ord y\subseteq\ord\pi\l(y\r)=\gen{p^\beta}$.

We now prove that $M\l(\mf{p}\r)\iso\bigoplus_{j=1}^{m}R/\!\gen{p^{\alpha_j}}$ by induction. If $m=1$, then $M\l(\mf{p}\r)\iso\gen{x_1}$ is cyclic and we are done. In general, assume w.l.o.g. that $\ord x_m=\gen{p^\alpha}$. Then $\bar{N}\coloneqq N/\!\gen{x_m}$ is generated by $\gen{x_j}_{j=1}^{m-1}$, so it admits a decomposition $\bar{N}\iso\bigoplus_{j=1}^{m-1}R/\!\gen{p^{\alpha_j}}$ for positive integers $\alpha_1\leq\cdots\leq\alpha_{m-1}$. For each $1\leq j\leq m-1$, the module $R/\!\gen{p^{\alpha_j}}$ is cyclic and hence can be generated by some $\bar{y}_j$ of order $\gen{p^{\alpha_j}}$. The above lemma then furnishes representatives $y_j$ of $\bar{y_j}$ having the same order, where we have $\gen{y_j}\iso R/\!\gen{p^{\alpha_j}}$ since the map $R\to\gen{y_j}:r\mapsto ry_j$ is surjective with kernel $\ord y_j=\gen{p^{\alpha_j}}$. This induces an isomorphism $\psi:\bar{N}\to\bigoplus_{j=1}^{m-1}\gen{y_j}$ such that $\pi\circ\psi=\id$, so the exact sequence $0\to\gen{x_m}\to N\to\bar{N}\to0$ splits and gives us the desired isomorphism $N\iso\gen{x_m}\oplus\bigoplus_{j=1}^{m-1}R/\!\gen{p^{\alpha_j}}\iso\bigoplus_{j=1}^mR/\!\gen{p^{\alpha_j}}$.

---

Thus there are elements $\bar{y_j}\in\bar{N}$ with orders $\gen{p^{\alpha_j}}$, so the above lemma furnishes representatives $y_j\in N$ with orders $\gen{p^{\alpha_j}}$. By the Splitting Lemma, we obtain $N\iso\gen{x_m}\oplus\bigoplus_{j=1}^{m-1}R/\!\gen{p^{\alpha_j}}$. Since $p^\alpha N=0$, we see that $p^\alpha R/\!\gen{p^{\alpha_{m-1}}}=0$ and hence $\alpha_{m-1}\leq\alpha\eqqcolon\alpha_m$.

---

Assume w.l.o.g. that $\ord x_m=\gen{p^\alpha}$. Set $\bar{N}\coloneqq N/\!\gen{x_m}$. Then $\mf{p}N_p=0$ (by definition of $N_p$), so it has a natural $R/\mf{p}$-vector space structure. Similarly for $\bar{N}_p$, and we claim that $\dim\bar{N}_p<\dim N_p$. Indeed, let $\l\{\bar{y}_k\r\}$ be a linearly independent subset of $\bar{N}_p$ and pick representatives $y_k$ of $\bar{y_k}$. Set $x\coloneqq p^{\alpha-1}x_m$, where we claim that $\l\{x\r\}\cup\l\{y_k\r\}$ is linearly independent. Indeed, consider the linear dependence $ax+\sum a_ky_k=0$ for some $a,a_k\in R$. The first term vanishes under $\pi$, so we have $\sum a_k\bar{y}_k=0$, whence $a_k=0$ for all $k$. Thus $ax=ap^{\alpha-1}x_m=0$, so $a=0$ since $\ord x_m=\gen{p^\alpha}$ and $a\divides p$ would contradict that $p$ is prime. Thus we may induct on the dimension of $N_p$, so suppose that $\bar{N}\iso\bigoplus_{j=1}^{m-1}R/\!\gen{p^{\alpha_j}}$ for some positive integers $\alpha_1\leq\cdots\leq\alpha_{m-1}$.

---

<i>Proof.</i> First, we note that the <i>existence</i> of the elementary divisors form of the decomposition follows from that of the invariant factors form, and that the <i>uniqueness</i> of the invariant factors form of the decomposition follows from that of the elementary divisors form.
* Assume the existence of an invariant factors decomposition $M\iso R^{\rk M}\oplus\bigoplus_{i=1}^nR/\!\gen{a_i}$. Fix any $a_i$ for $1\leq i\leq n$, which, since $R$ is a UFD, can be written as $a_i=u_i\prod_{j=1}^mp_j^{r_{ij}}$ for some $u_i\in R^\times$ and distinct primes $p_j\in R$. But for all $j\neq k$, the ideal $\langle p_j^{r_{ij}}\rangle+\langle p_k^{r_{ik}}\rangle$ is generated by its greatest common divisor, which is $1$, and hence the ideals $\langle p_j^{r_{ij}}\rangle$ are pairwise comaximal. Their product is $\gen{a_i}$, so $R/\!\gen{a_i}\iso\bigoplus_{j=1}^mR/\langle p_j^{r_{ij}}\rangle$ by the CRT. Taking the direct sum over all $a_i$ in the invariant factor decomposition gives us the desired elementary divisors.
* Assume the uniqueness of the elementary divisors decomposition $M\iso R^{\rk M}\oplus\bigoplus_{ij}R/\!\gen{p_i^{r_{ij}}}$. Let $\gen{a_1}\supseteq\gen{a_2}\supseteq\cdots\supseteq\gen{a_n}$ and $\gen{b_1}\supseteq\gen{b_2}\supseteq\cdots\supseteq\gen{b_{n'}}$ be invariant factors of $M$, so the elementary divisors are the prime power factors of those elements. But $a_1\divides\cdots\divides a_n$ forces $a_n$ to be the product of all the distinct primes $p_j$ with the largest powers $r_{ij}$. The same is true for $b_{n'}$, so $\gen{a_n}=\gen{b_{n'}}$. That $n=n'$ and $\gen{a_i}=\gen{b_i}$ for all $1\leq i\leq n$ follows by induction.

We now show the existence of the invariant factors decomposition.
* Since $M$ is finitely-generated, there is a surjection $\pi:R^k\onto M$ for some $k\in\N$. Then there is a basis $\tpl{x_j}_{j=1}^k$ of $R^k$ and non-zero elements $\tpl{a_i}_{i=1}^n$ of $R$ with $n\leq k$ and $a_1\divides\cdots\divides a_n$ such that $\tpl{a_ix_i}_{i=1}^n$ is a basis for $\ker\pi$. Consider the surjective $R$-module homomorphism
$$\begin{equation}
    \phi:\bigoplus_{i=1}^{k}\gen{x_i}\to R^{k-n}\oplus\bigoplus_{i=1}^{n}R/\!\gen{a_i}\ \ \ \ \ \ \ \ \textrm{mapping}\ \ \ \ \ \ \ \ \tpl{r_ix_i}_{i=1}^k\mapsto\tpl{r_{n+1},\dots,r_k,r_1+\gen{a_1},\dots,r_n+\gen{a_n}}.
\end{equation}$$
Its kernel is $\ker\phi=\ker\pi$, whence $M\iso R^k/\ker\pi\iso R^{k-n}\oplus\bigoplus_{i=1}^{n}R/\!\gen{a_i}$. <b>$\color{red}\textrm{continue here...}$</b>

Finally, we show that the elementary divisors decomposition for $M$ is unique. Assume w.l.o.g. that $M$ is torsion. We wish to show that if there is an isomorphism
$$\begin{equation}
    \bigoplus_{i=1}^{n}\bigoplus_{j=1}^{m}R/\langle p_j^{r_{ij}}\rangle\iso\bigoplus_{i=1}^{n'}\bigoplus_{j=1}^{m'}R/\langle q_j^{s_{ij}}\rangle
\end{equation}$$
where $p_j,q_j\in R$ are prime and $r_{ij},s_{ij}\in\N$ are positive integers, then $n=n'$, $m=m'$, and, up to a permutation, $\gen{p_j}=\gen{q_j}$ and $r_{ij}=s_{ij}$ for all $i,j$. We claim that the annihilator $\Ann M$ is generated by $a\coloneqq\prod_{j=1}^{m}p_j^{\max_ir_{ij}}$, and that the ideals $\gen{p_j}$ are precisely the prime ideals of $R$ containing $\Ann M$.
* If $r\in\Ann M$, then $rm=0$ for all $m\in M$. In particular, we have $r\,(1+\langle p_j^{r_{ij}}\rangle)=r+\langle p_j^{r_{ij}}\rangle=\langle p_j^{r_{ij}}\rangle$ for all $i,j$, so $r\in\langle p_j^{r_{ij}}\rangle\subseteq\gen{a}$

---

Note that the two elementary divisor decompositions of $M$ induce two invariant factor decompositions of $M$ as $\bigoplus_{i=1}^{n}R/\!\gen{a_i}\iso\bigoplus_{i=1}^{n'}R/\!\gen{b_i}$ by the CRT. We claim that the ideals $\gen{p_j}$ are precisely the prime ideals that contain the annihilator $\Ann M=\gen{a_n}$.
* If $r\in\Ann M$, then $rm=0$ for all $m\in M$. In particular, we have $r\tpl{1,\dots,1}=\tpl{r,\dots,r}=0$, so $r\in\gen{a_i}$ for all $1\leq i\leq n$ and in particular $r\in\gen{a_n}$. Conversely, if $r\in\gen{a_n}$, then $r\in\gen{a_i}$ for all $i$. Take $m\in M$, which we identify with $\tpl{m_1\dots,m_n}$ for $m_i\in R/\!\gen{a_i}$. Then $rm_i=0$ for all $1\leq i\leq n$, so $rm=0$.

We now claim that $\gen{p_j}$ are precisely the prime ideals in $R$ containing $\Ann M=\gen{a_n}$. Indeed, the prime decomposition $a_n=u\prod_{j=1}^{n}p_j^{\max_ir_{ij}}$ shows that $\gen{a_n}\subseteq\gen{p_j}$ for all $1\leq j\leq m$. Conversely, if $\gen{p}$ is a prime ideal in $R$ containing $\gen{a_n}$, then $\prod_{j=1}^{m}p_j^{r_j}\in\gen{p}$ and hence $p_j\in\gen{p}$ for some $1\leq j\leq n$. Since $p\not\in R^\times$, we see that $p_j=cp$ implies that $c\in R^\times$, so $p\in\gen{p_j}$ too and hence $\gen{p}=\gen{p_j}$.
